{% extends 'settings/admin_layout.html' %}
{% block title %}{{ server.server_name }}{% endblock %}
{% load i18n %}

{% block header %}
{{ server.server_name }}

{% if server.status == "blocked" %}<span class="icon icon-x has-text-danger is-size-5" title="{% trans 'Blocked' %}"><span class="is-sr-only">{% trans "Blocked" %}</span></span>
{% endif %}

<a href="{% url 'settings-federation' %}" class="has-text-weight-normal help">{% trans "Back to server list" %}</a>
{% endblock %}

{% block edit-button %}
<a href="{% url 'settings-edit-federated-server' server.id %}">
    <span class="icon icon-pencil" title="{% trans 'Edit server' %}">
        <span class="is-sr-only">{% trans "Edit server" %}</span>
    </span>
</a>
{% endblock %}

{% block panel %}
<div class="columns">
    <section class="column is-half content">
        <h2 class="title is-4">{% trans "Details" %}</h2>
        <dl>
            <div class="is-flex">
                <dt>{% trans "Software:" %}</dt>
                <dd>{{ server.application_type }}</dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Version:" %}</dt>
                <dd>{{ server.application_version }}</dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Status:" %}</dt>
                <dd>{{ server.status }}</dd>
            </div>
        </dl>
    </section>

    <section class="column is-half content">
        <h2 class="title is-4">{% trans "Activity" %}</h2>
        <dl>
            <div class="is-flex">
                <dt>{% trans "Users:" %}</dt>
                <dd>
                    {{ users.count }}
                    {% if server.user_set.count %}(<a href="{% url 'settings-users' %}?server={{ server.id }}">{% trans "View all" %}</a>){% endif %}
                </dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Reports:" %}</dt>
                <dd>
                    {{ reports.count }}
                    {% if reports.count %}(<a href="{% url 'settings-reports' %}?server={{ server.id }}">{% trans "View all" %}</a>){% endif %}
                </dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Followed by us:" %}</dt>
                <dd>
                    {{ followed_by_us.count }}
                </dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Followed by them:" %}</dt>
                <dd>
                    {{ followed_by_them.count }}
                </dd>
            </div>
            <div class="is-flex">
                <dt>{% trans "Blocked by us:" %}</dt>
                <dd>
                    {{ blocked_by_us.count }}
                </dd>
            </div>
        </dl>
    </section>
</div>

<section class="block content">
    <h2 class="title is-4">{% trans "Notes" %}</h2>
    <p>{{ server.notes }}</p>
</section>

<section class="block content">
    <h2 class="title is-4">{% trans "Actions" %}</h2>
    <form class="block" method="post" action="{% url 'settings-federated-server' server.id %}">
        {% csrf_token %}
        {% if server.status != 'blocked' %}
        <button class="button is-danger">{% trans "Block" %}</button>
        <p class="help">{% trans "All users from this instance will be deactivated." %}</p>
        {% else %}
        <button class="button">{% trans "Un-block" %}</button>
        <p class="help">{% trans "All users from this instance will be re-activated." %}</p>
        {% endif %}
    </form>
</section>

{% endblock %}

