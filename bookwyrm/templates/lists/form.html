{% load i18n %}
{% csrf_token %}
{% load utilities %}
<input type="hidden" name="user" value="{{ request.user.id }}">

<div class="columns">
    <div class="column is-two-thirds">
        <div class="field">
            <label class="label" for="id_name">{% trans "Name:" %}</label>
            {{ list_form.name }}
        </div>
        <div class="field">
            <label class="label" for="id_description">{% trans "Description:" %}</label>
            {{ list_form.description }}
        </div>
    </div>
    <div class="column">
        <fieldset class="field">
            <legend class="label">{% trans "List curation:" %}</legend>

            <label class="field">
                <input type="radio" name="curation" value="closed"{% if not list or list.curation == 'closed' %} checked{% endif %}> {% trans "Closed" %}
                <p class="help mb-2">{% trans "Only you can add and remove books to this list" %}</p>
            </label>

            <label class="field">
                <input type="radio" name="curation" value="curated"{% if list.curation == 'curated' %} checked{% endif %}> {% trans "Curated" %}
                <p class="help mb-2">{% trans "Anyone can suggest books, subject to your approval" %}</p>
            </label>

            <label class="field">
                <input type="radio" name="curation" value="open"{% if list.curation == 'open' %} checked{% endif %}> {% trans "Open" %}
                <p class="help mb-2">{% trans "Anyone can add books to this list" %}</p>
            </label>

            <label class="field">
              <input type="radio" name="curation" value="group"{% if list.curation == 'group' %} checked{% endif %}> {% trans "Group" %}
              <p class="help mb-2">{% trans "Group members can add to and remove from this list" %}</p>
          </label>
          <!-- TODO: add a list picker on-select for group lists -->
            {% if user_groups %}
              {% csrf_token %}
              <label class="label" for="id_group">{% trans "Select Group" %}</label>
              <div class="field has-addons">
                  <div class="select control">
                      <select name="group" id="id_group">
                          <option value="">Select a list</option>
                          {% for group in user_groups %}
                          <option value="{{ group.id }}" {% if list.group.id == group.id %} selected{% endif %}>{{ group.name }}</option>
                          {% endfor %}
                      </select>
                  </div>
              </div>
              {% else %}
              {% with user|username as username %}
              {% url 'user-groups' user|username as url %}
              <div>{% trans "You must create a " %}<a href="{{ url }}">{% trans "Group" %}</a>{% trans " before you can create Group lists!" %}</div>
              {% endwith %}
              {% endif %}
        </fieldset>
    </div>
</div>
<div class="columns is-mobile">
    <div class="column">
        <div class="field has-addons">
            <div class="control">
                {% include 'snippets/privacy_select.html' with current=list.privacy %}
            </div>
            <div class="control">
                <button type="submit" class="button is-primary">{% trans "Save" %}</button>
            </div>
        </div>
    </div>
    {% if list.id %}
    <div class="column is-narrow">
        {% trans "Delete list" as button_text %}
        {% include 'snippets/toggle/toggle_button.html' with class="is-danger" text=button_text icon_with_text="x" controls_text="delete_list" controls_uid=list.id focus="modal_title_delete_list" %}
    </div>
    {% endif %}
</div>
